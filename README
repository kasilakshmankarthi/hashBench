Adapted to SPA/V8 specifics from http://www.azillionmonkeys.com/qed/hash.html
